package io.github.habatoo.services;

import io.github.habatoo.dto.CashDto;
import io.github.habatoo.dto.OperationResultDto;
import reactor.core.publisher.Mono;

/**
 * Бизнес-сервис для обработки операций с наличными средствами.
 * <p>
 * Данный интерфейс определяет методы для управления жизненным циклом кассовых транзакций:
 * валидацию данных, проверку достаточности средств на счете (при списании),
 * фиксацию операции в истории и обновление баланса пользователя.
 * </p>
 * <p>
 * Все операции выполняются в реактивном неблокирующем стиле, обеспечивая высокую
 * производительность при большом количестве одновременных запросов.
 * </p>
 */
public interface CashService {

    /**
     * Выполняет обработку кассовой операции (депозит или снятие).
     * <p>
     * Метод инкапсулирует в себе следующую бизнес-логику:
     * <ul>
     * <li>Идентификация счета пользователя по логину.</li>
     * <li>Атомарное обновление текущего баланса.</li>
     * <li>Создание записи в реестре транзакций.</li>
     * <li>Формирование уведомления об успешном или неуспешном завершении.</li>
     * </ul>
     * </p>
     *
     * @param login   уникальный логин пользователя, инициирующего операцию.
     * @param cashDto объект с данными о типе операции (action) и сумме (value).
     * @return {@link Mono}, содержащий {@link OperationResultDto} с результатом выполнения
     * и деталями транзакции для фронтенд-слоя.
     * @throws RuntimeException в случае нарушения бизнес-правил (например, недостаточный баланс).
     */
    Mono<OperationResultDto<CashDto>> processCashOperation(String login, CashDto cashDto);
}
