# Микросервис аккаунтов (Accounts)

Микросервис Account является ядром системы. 
Он отвечает за хранение персональных данных клиентов и управление их финансовыми профилями (балансом).
Сервис хранит:
* логин пользователя (аккаунт связывается с вошедшим пользователем по этому логину и логину из JWT);
* фамилия и имя;
* дата рождения;
* количество денег на счету.

### Основные функции:
<br>
* Хранение и обновление ФИО и даты рождения.
* Проверка возраста (бизнес-валидация 18+).
* Предоставление актуального баланса для сервисов Cash и Transfer.

### API EndpointsСервис работает по протоколу REST.
Фронт выполняет REST-запросы (в формате JSON) из блока данных аккаунта в сервис Accounts:
* при получении данных своего аккаунта;
* при редактировании данных своего аккаунта;
* при получении логина и фамилии и имени других аккаунтов для выполнения переводов.

| Метод    | Эндпоинт      | Описание                              | Ответы |
|:---------|:--------------|:--------------------------------------|:--- |
| **POST**  | `/balance/`   | Получить баланс текущего пользователя | 200 OK / 400 Bad Request |
| **GET**  | `/users/`     | Получить данные всех пользователей    | 200 OK / 400 Bad Request |
| **GET**  | `/user/`      | Получить данные текущего пользователя | 200 OK / 400 Bad Request |
| **POST** | `/update/`    | Обновить данные пользователя          | 200 OK / 400 (недост. средств) |

<br>Accounts выполняет REST-запросы (в формате JSON) в Notifications.

### Интеграция
Сервис использует Keycloak для проверки JWT-токенов. 
При запросе данных другого пользователя сервис вернет 403 Forbidden, если у запрашивающего нет прав администратора.

### Разработка и запуск
Сборка модуля - только этот модуль локально:
```bash

./gradlew :account:bootJar
```
### Запуск тестов
Модуль содержит контрактные тесты и интеграционные тесты с использованием Testcontainers:
```bash

./gradlew :account:test
```
<hr>

[Вернуться к главному README](../README.md)