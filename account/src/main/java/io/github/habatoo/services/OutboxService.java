package io.github.habatoo.services;

/**
 * Сервис для обработки событий по паттерну Transactional Outbox.
 * <p>
 * Обеспечивает надежную передачу данных во внешние системы (например, сервис уведомлений),
 * гарантируя, что события не будут потеряны даже в случае сбоев сети или временной
 * недоступности сторонних сервисов.
 * </p>
 */
public interface OutboxService {

    /**
     * Выполняет обработку накопленных событий из таблицы Outbox.
     * <p>
     * Метод считывает записи, которые еще не были успешно отправлены,
     * и инициирует их передачу. Запускается автоматически каждые 5 секунд.
     * Использование {@code fixedDelay} гарантирует, что между завершением
     * текущей итерации и началом следующей всегда будет пауза в 5 секунд,
     * что предотвращает наложение задач при высокой нагрузке.
     * </p>
     */
    void processOutboxEvents();

    /**
     * Производит регламентную очистку базы данных от обработанных записей.
     * <p>
     * Удаляет старые записи (например, успешно отправленные или те, по которым
     * превышен лимит попыток), чтобы предотвратить чрезмерное разрастание
     * таблицы Outbox. Запускается автоматически раз в час (3600000 мс).
     * </p>
     */
    void cleanupOldRecords();
}
