# Микросервис уведомлений (Notification)

Микросервис **Notification** отвечает за сбор, регистрацию и оповещение о финансовых событиях, происходящих в системе. Он консолидирует информацию о депозитах, снятиях и переводах, формируя историю транзакций.

### Основные функции:
* **Логирование транзакций:** Получение и хранение данных о каждой успешной финансовой операции.
* **Формирование истории:** Предоставление пользователю списка последних действий с его счетом.
* **Централизованная обработка:** Единая точка входа для всех типов системных уведомлений.

### API Endpoints
Сервис предоставляет REST-интерфейс для регистрации событий от других микросервисов и для чтения истории пользователем.

| Метод | Эндпоинт         | Описание | Инициатор |
|:--- |:-----------------|:--- |:--- |
| **POST** | `/notifications` | Записать новое финансовое событие | Cash / Transfer |

**Типы регистрируемых событий:**
1. **CASH_DEPOSIT:** Успешное пополнение баланса.
2. **CASH_WITHDRAW:** Снятие наличных.
3. **TRANSFER_SEND:** Отправка перевода другому клиенту.
4. **TRANSFER_RECEIVE:** Получение перевода от другого клиента.

### Логика взаимодействия
1. **Прием данных:** Сервисы `Cash` `Account` или `Transfer` вызывают POST-метод после завершения финансовой операции.
2. **Обогащение:** Сервис фиксирует точное время события (timestamp) и тип операции.

### Интеграция и безопасность
* **JWT Validation:** Использование Keycloak для проверки прав доступа. Пользователь видит только свои уведомления.
* **Реактивность:** Построен на Spring WebFlux для эффективной обработки большого потока логов.
* **Хранение:** Все события сохраняются в базу данных PostgreSQL через R2DBC.

### Разработка и запуск
Сборка только модуля Notification локально:
```bash

./gradlew :notification:bootJar
```

### Запуск тестов
Модуль содержит тесты корректности фильтрации логов и интеграционные тесты сохранения данных:
```bash

./gradlew :notification:test
```
<hr>

[Вернуться к главному README](../README.md)